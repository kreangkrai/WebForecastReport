@{
    Layout = "~/Views/Shared/_Layout.cshtml";
    ViewData["Title"] = "Quotation Report";
}
<style>
    .highlight {
        font-weight: bold;
    }

    .dataTables_scrollHeadInner,
    .table {
        width: 100% !important;
    }

    td.index_department {
        background-color: #F5F4B6;
        border-top: 1px solid white !important;
        font-weight: 600;
        text-align: center;
    }

    td.index_year {
        background-color: #F5F4B6;
        border-top: 1px solid white !important;
        font-weight: 600;
        text-align: center;
    }
    td.index_quarter {
        background-color: #F5F4B6;
        border-top: 1px solid white !important;
        font-weight: 600;
        text-align: center;
    }
</style>
<div class="row p-3">
    <div class="col-md-12 col-xl-12">
        <ul class="nav nav-tabs pl-2 pb-2" id="myTab" role="tablist">
            <li class="nav-item" role="presentation">
                <a class="nav-link active" id="report_department-tab" data-toggle="tab" href="#report_department" role="tab" aria-controls="report_department" aria-selected="true"><b>Report Department</b></a>
            </li>
            <li class="nav-item" role="presentation">
                <a class="nav-link" id="report_quarter-tab" data-toggle="tab" href="#report_quarter" role="tab" aria-controls="report_quarter" aria-selected="false"><b>Report Quarter</b></a>
            </li>
             <li class="nav-item" role="presentation">
                <a class="nav-link" id="report_pending-tab" data-toggle="tab" href="#report_pending" role="tab" aria-controls="report_pending" aria-selected="false"><b>Report Pending In Out</b></a>
            </li>
            <li class="nav-item" role="presentation">
                <a class="nav-link" id="report_year-tab" data-toggle="tab" href="#report_year" role="tab" aria-controls="report_year" aria-selected="false"><b>Report Year</b></a>
            </li>
            <li class="nav-item" role="presentation">
                <a class="nav-link" id="report_status-tab" data-toggle="tab" href="#report_status" role="tab" aria-controls="report_status" aria-selected="false"><b>Report Status</b></a>
            </li>
        </ul>
    </div>
    <div class="tab-content container-fluid" id="myTabContent">
        <div class="tab-pane fade show active" id="report_department" role="tabpanel" aria-labelledby="home-tab">
            <div class="col-md-12 col-xl-12">
                <div class="card">
                    <div class="card-header">
                        <span class="card-title"><b>Quotations Report Department</b></span>
                    </div>
                    <div class="card-body">
                        <div class="col-md-12 col-xl-12">
                            <div class="row d-flex justify-content-between">
                                <div class="col-md-8 col-xl-8 pb-3">
                                    <div class="row">
                                        <div class="col-md-2 col-xl-2 pb-3">
                                            <select id="department" class="form-control">
                                            </select>
                                        </div>
                                        <div class="col-md-4 col-xl-4 pb-3">
                                            <input type="month" id="month_first" class="form-control" />
                                        </div>
                                        <div class="col-md-4 col-xl-4 pb-3">
                                            <input type="month" id="month_last" class="form-control" />
                                        </div>
                                        <div class="col-md-2 col-xl-2 pb-3">
                                            <button type="button" id="btnOK" class="btn btn-primary form-control">OK</button>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-2 col-xl-2 pb-3">
                                    <button type="button" id="export_department" class="btn btn-success form-control">Export</button>
                                </div>
                            </div>
                        </div>
                        <div class="col-12" id="chkGroup_department" hidden>
                            <div class="form-group row">
                                <div class="col-12">
                                    <div class="row">
                                        <div class="col-md-2 col-xl-2">
                                            <input type="checkbox" id="chkProject_department" />
                                            <label>Project</label>
                                        </div>
                                        <div class="col-md-2 col-xl-2">
                                            <input type="checkbox" id="chkProduct_department" />
                                            <label>Product</label>
                                        </div>
                                        <div class="col-md-2 col-xl-2">
                                            <input type="checkbox" id="chkService_department" />
                                            <label>Service</label>
                                        </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-md-2 col-xl-2">
                                                <input type="checkbox" id="chkWon_department" />
                                                <label>Won</label>
                                            </div>
                                            <div class="col-md-2 col-xl-2">
                                                <input type="checkbox" id="chkLoss_department" />
                                                <label>Loss</label>
                                            </div>
                                            <div class="col-md-2 col-xl-2">
                                                <input type="checkbox" id="chkNogo_department" />
                                                <label>No go</label>
                                            </div>
                                            <div class="col-md-2 col-xl-2">
                                                <input type="checkbox" id="chkPending_department" />
                                                <label>Pending</label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-12">
                                <table id="table_department" class="table table-xl cell-border table-dark table-bordered display text-center responsive nowrap" style="width:100%">
                                    <thead style="color:black;background-color:#71C6F7">
                                        <tr>
                                            <th rowspan="4" style="text-align:center;vertical-align:middle;">Department</th>
                                            <th rowspan="4" style="text-align:center;vertical-align:middle;">Sales Name</th>
                                            <th colspan="2" style="text-align:center;vertical-align:middle;">Quotation</th>
                                            <th colspan="30" style="text-align:center;vertical-align:middle;">Description</th>
                                            <th colspan="32" style="text-align:center;vertical-align:middle;">Status Quotation</th>
                                        </tr>
                                        <tr>
                                            <th rowspan="3" style="text-align:center;vertical-align:middle;">Total Quo.</th>
                                            <th rowspan="3" style="text-align:center;vertical-align:middle;">Total MB</th>
                                            <th colspan="10" style="text-align:center;vertical-align:middle;">Project</th>
                                            <th colspan="10" style="text-align:center;vertical-align:middle;">Product</th>
                                            <th colspan="10" style="text-align:center;vertical-align:middle;">Service</th>
                                            <th colspan="8" style="text-align:center;vertical-align:middle;">Won</th>
                                            <th colspan="8" style="text-align:center;vertical-align:middle;">Loss</th>
                                            <th colspan="8" style="text-align:center;vertical-align:middle;">No go</th>
                                            <th colspan="8" style="text-align:center;vertical-align:middle;">Pending</th>
                                        </tr>
                                        <tr>
                                            <th colspan="2" style="text-align:center;vertical-align:middle;">Won</th>
                                            <th colspan="2" style="text-align:center;vertical-align:middle;">Loss</th>
                                            <th colspan="2" style="text-align:center;vertical-align:middle;">No go</th>
                                            <th colspan="2" style="text-align:center;vertical-align:middle;">Pending</th>
                                            <th rowspan="2" style="text-align:center;vertical-align:middle;">Quo.</th>
                                            <th rowspan="2" style="text-align:center;vertical-align:middle;">MB</th>

                                            <th colspan="2" style="text-align:center;vertical-align:middle;">Won</th>
                                            <th colspan="2" style="text-align:center;vertical-align:middle;">Loss</th>
                                            <th colspan="2" style="text-align:center;vertical-align:middle;">No go</th>
                                            <th colspan="2" style="text-align:center;vertical-align:middle;">Pending</th>
                                            <th rowspan="2" style="text-align:center;vertical-align:middle;">Quo.</th>
                                            <th rowspan="2" style="text-align:center;vertical-align:middle;">MB</th>

                                            <th colspan="2" style="text-align:center;vertical-align:middle;">Won</th>
                                            <th colspan="2" style="text-align:center;vertical-align:middle;">Loss</th>
                                            <th colspan="2" style="text-align:center;vertical-align:middle;">No go</th>
                                            <th colspan="2" style="text-align:center;vertical-align:middle;">Pending</th>
                                            <th rowspan="2" style="text-align:center;vertical-align:middle;">Quo.</th>
                                            <th rowspan="2" style="text-align:center;vertical-align:middle;">MB</th>

                                            <th colspan="2" style="text-align:center;vertical-align:middle;">Project</th>
                                            <th colspan="2" style="text-align:center;vertical-align:middle;">Product</th>
                                            <th colspan="2" style="text-align:center;vertical-align:middle;">Service</th>
                                            <th rowspan="2" style="text-align:center;vertical-align:middle;">Quo.</th>
                                            <th rowspan="2" style="text-align:center;vertical-align:middle;">MB</th>

                                            <th colspan="2" style="text-align:center;vertical-align:middle;">Project</th>
                                            <th colspan="2" style="text-align:center;vertical-align:middle;">Product</th>
                                            <th colspan="2" style="text-align:center;vertical-align:middle;">Service</th>
                                            <th rowspan="2" style="text-align:center;vertical-align:middle;">Quo.</th>
                                            <th rowspan="2" style="text-align:center;vertical-align:middle;">MB</th>

                                            <th colspan="2" style="text-align:center;vertical-align:middle;">Project</th>
                                            <th colspan="2" style="text-align:center;vertical-align:middle;">Product</th>
                                            <th colspan="2" style="text-align:center;vertical-align:middle;">Service</th>
                                            <th rowspan="2" style="text-align:center;vertical-align:middle;">Quo.</th>
                                            <th rowspan="2" style="text-align:center;vertical-align:middle;">MB</th>

                                            <th colspan="2" style="text-align:center;vertical-align:middle;">Project</th>
                                            <th colspan="2" style="text-align:center;vertical-align:middle;">Product</th>
                                            <th colspan="2" style="text-align:center;vertical-align:middle;">Service</th>
                                            <th rowspan="2" style="text-align:center;vertical-align:middle;">Quo.</th>
                                            <th rowspan="2" style="text-align:center;vertical-align:middle;">MB</th>
                                        </tr>
                                        <tr>
                                            <th style="text-align:center;vertical-align:middle;">Quo.</th>
                                            <th style="text-align:center;vertical-align:middle;">MB</th>
                                            <th style="text-align:center;vertical-align:middle;">Quo.</th>
                                            <th style="text-align:center;vertical-align:middle;">MB</th>
                                            <th style="text-align:center;vertical-align:middle;">Quo.</th>
                                            <th style="text-align:center;vertical-align:middle;">MB</th>
                                            <th style="text-align:center;vertical-align:middle;">Quo.</th>
                                            <th style="text-align:center;vertical-align:middle;">MB</th>

                                            <th style="text-align:center;vertical-align:middle;">Quo.</th>
                                            <th style="text-align:center;vertical-align:middle;">MB</th>
                                            <th style="text-align:center;vertical-align:middle;">Quo.</th>
                                            <th style="text-align:center;vertical-align:middle;">MB</th>
                                            <th style="text-align:center;vertical-align:middle;">Quo.</th>
                                            <th style="text-align:center;vertical-align:middle;">MB</th>
                                            <th style="text-align:center;vertical-align:middle;">Quo.</th>
                                            <th style="text-align:center;vertical-align:middle;">MB</th>

                                            <th style="text-align:center;vertical-align:middle;">Quo.</th>
                                            <th style="text-align:center;vertical-align:middle;">MB</th>
                                            <th style="text-align:center;vertical-align:middle;">Quo.</th>
                                            <th style="text-align:center;vertical-align:middle;">MB</th>
                                            <th style="text-align:center;vertical-align:middle;">Quo.</th>
                                            <th style="text-align:center;vertical-align:middle;">MB</th>
                                            <th style="text-align:center;vertical-align:middle;">Quo.</th>
                                            <th style="text-align:center;vertical-align:middle;">MB</th>

                                            <th style="text-align:center;vertical-align:middle;">Quo.</th>
                                            <th style="text-align:center;vertical-align:middle;">MB</th>
                                            <th style="text-align:center;vertical-align:middle;">Quo.</th>
                                            <th style="text-align:center;vertical-align:middle;">MB</th>
                                            <th style="text-align:center;vertical-align:middle;">Quo.</th>
                                            <th style="text-align:center;vertical-align:middle;">MB</th>

                                            <th style="text-align:center;vertical-align:middle;">Quo.</th>
                                            <th style="text-align:center;vertical-align:middle;">MB</th>
                                            <th style="text-align:center;vertical-align:middle;">Quo.</th>
                                            <th style="text-align:center;vertical-align:middle;">MB</th>
                                            <th style="text-align:center;vertical-align:middle;">Quo.</th>
                                            <th style="text-align:center;vertical-align:middle;">MB</th>

                                            <th style="text-align:center;vertical-align:middle;">Quo.</th>
                                            <th style="text-align:center;vertical-align:middle;">MB</th>
                                            <th style="text-align:center;vertical-align:middle;">Quo.</th>
                                            <th style="text-align:center;vertical-align:middle;">MB</th>
                                            <th style="text-align:center;vertical-align:middle;">Quo.</th>
                                            <th style="text-align:center;vertical-align:middle;">MB</th>

                                            <th style="text-align:center;vertical-align:middle;">Quo.</th>
                                            <th style="text-align:center;vertical-align:middle;">MB</th>
                                            <th style="text-align:center;vertical-align:middle;">Quo.</th>
                                            <th style="text-align:center;vertical-align:middle;">MB</th>
                                            <th style="text-align:center;vertical-align:middle;">Quo.</th>
                                            <th style="text-align:center;vertical-align:middle;">MB</th>
                                        </tr>
                                    </thead>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
        </div>
        <div class="tab-pane fade" id="report_quarter" role="tabpanel" aria-labelledby="profile-tab">
                <div class="col-md-12 col-xl-12">
                    <div class="card">
                        <div class="card-header">
                            <span class="card-title"><b>Quotations Report Quarter</b></span>
                        </div>
                        <div class="card-body">
                            <div class="col-md-12 col-xl-12">
                                <div class="row d-flex justify-content-between">
                                    <div class="col-md-6 col-xl-6 pb-3">
                                        <div class="row">
                                            <div class="col-md-4 col-xl-4 pb-3">
                                                <select id="quarter_department" class="form-control">
                                                </select>
                                            </div>
                                            <div class="col-md-4 col-xl-4 pb-3">
                                                <select id="quarter_year" class="form-control">
                                                </select>
                                            </div>
                                            <div class="col-md-3 col-xl-3 pb-3">
                                                <button type="button" id="btnquarter_OK" class="btn btn-primary form-control">OK</button>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-2 col-xl-2 pb-3">
                                        <button type="button" id="export_quarter" class="btn btn-success form-control">Export</button>
                                    </div>
                                </div>
                            </div>
                            <div class="col-12" id="chkGroup" hidden>
                                <div class="form-group row">
                                    <div class="col-4">
                                        <div class="row">
                                            <div class="col-2">
                                                <input type="checkbox" id="chkQ1" />
                                                <label>Q1</label>
                                            </div>
                                            <div class="col-2">
                                                <input type="checkbox" id="chkQ2" />
                                                <label>Q2</label>
                                            </div>
                                            <div class="col-2">
                                                <input type="checkbox" id="chkQ3" />
                                                <label>Q3</label>
                                            </div>
                                            <div class="col-2">
                                                <input type="checkbox" id="chkQ4" />
                                                <label>Q4</label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-12">
                                <table id="table_quarter" class="table-xl cell-border  table-dark  table-bordered display responsive nowrap " style="width:100%">
                                    <thead style="color:black;background-color:#2F75B5">
                                        <tr>
                                            <th colspan="2" rowspan="2" style="text-align:center;vertical-align:middle">Sale</th>
                                            <th colspan="8" style="text-align:center;background-color:#EFF5EC">Q1</th>
                                            <th colspan="8" style="text-align:center;background-color:#C7D0C4">Q2</th>
                                            <th colspan="8" style="text-align:center;background-color:#BCD9B2">Q3</th>
                                            <th colspan="8" style="text-align:center;background-color:#ADE3DF">Q4</th>

                                        </tr>
                                        <tr>
                                            <th colspan="2" style="text-align:center;vertical-align:middle;background-color:#EFF5EC">January</th>
                                            <th colspan="2" style="text-align:center;vertical-align:middle;background-color:#EFF5EC">February</th>
                                            <th colspan="2" style="text-align:center;vertical-align:middle;background-color:#EFF5EC">March</th>
                                            <th colspan="2" style="text-align:center;vertical-align:middle;background-color:#EFF5EC">Total Q1</th>
                                            <th colspan="2" style="text-align:center;vertical-align:middle;background-color:#C7D0C4">April</th>
                                            <th colspan="2" style="text-align:center;vertical-align:middle;background-color:#C7D0C4">May</th>
                                            <th colspan="2" style="text-align:center;vertical-align:middle;background-color:#C7D0C4">June</th>
                                            <th colspan="2" style="text-align:center;vertical-align:middle;background-color:#C7D0C4">Total Q2</th>
                                            <th colspan="2" style="text-align:center;vertical-align:middle;background-color:#BCD9B2">July</th>
                                            <th colspan="2" style="text-align:center;vertical-align:middle;background-color:#BCD9B2">August</th>
                                            <th colspan="2" style="text-align:center;vertical-align:middle;background-color:#BCD9B2">September</th>
                                            <th colspan="2" style="text-align:center;vertical-align:middle;background-color:#BCD9B2">Total Q3</th>
                                            <th colspan="2" style="text-align:center;vertical-align:middle;background-color:#ADE3DF">October</th>
                                            <th colspan="2" style="text-align:center;vertical-align:middle;background-color:#ADE3DF">November</th>
                                            <th colspan="2" style="text-align:center;vertical-align:middle;background-color:#ADE3DF">December</th>
                                            <th colspan="2" style="text-align:center;vertical-align:middle;background-color:#ADE3DF">Total Q4</th>
                                        </tr>
                                        <tr>
                                            <th style="text-align:center;vertical-align:middle;background-color:#EFF5EC">Department</th>
                                            <th style="text-align:center;vertical-align:middle;background-color:#EFF5EC">Sale Name</th>
                                            <th style="text-align:center;vertical-align:middle;background-color:#EFF5EC">IN</th>
                                            <th style="text-align:center;vertical-align:middle;background-color:#EFF5EC">OUT</th>
                                            <th style="text-align:center;vertical-align:middle;background-color:#EFF5EC">IN</th>
                                            <th style="text-align:center;vertical-align:middle;background-color:#EFF5EC">OUT</th>
                                            <th style="text-align:center;vertical-align:middle;background-color:#EFF5EC">IN</th>
                                            <th style="text-align:center;vertical-align:middle;background-color:#EFF5EC">OUT</th>
                                            <th style="text-align:center;vertical-align:middle;background-color:#EFF5EC">IN</th>
                                            <th style="text-align:center;vertical-align:middle;background-color:#EFF5EC">OUT</th>
                                            <th style="text-align:center;vertical-align:middle;background-color:#C7D0C4">IN</th>
                                            <th style="text-align:center;vertical-align:middle;background-color:#C7D0C4">OUT</th>
                                            <th style="text-align:center;vertical-align:middle;background-color:#C7D0C4">IN</th>
                                            <th style="text-align:center;vertical-align:middle;background-color:#C7D0C4">OUT</th>
                                            <th style="text-align:center;vertical-align:middle;background-color:#C7D0C4">IN</th>
                                            <th style="text-align:center;vertical-align:middle;background-color:#C7D0C4">OUT</th>
                                            <th style="text-align:center;vertical-align:middle;background-color:#C7D0C4">IN</th>
                                            <th style="text-align:center;vertical-align:middle;background-color:#C7D0C4">OUT</th>
                                            <th style="text-align:center;vertical-align:middle;background-color:#BCD9B2">IN</th>
                                            <th style="text-align:center;vertical-align:middle;background-color:#BCD9B2">OUT</th>
                                            <th style="text-align:center;vertical-align:middle;background-color:#BCD9B2">IN</th>
                                            <th style="text-align:center;vertical-align:middle;background-color:#BCD9B2">OUT</th>
                                            <th style="text-align:center;vertical-align:middle;background-color:#BCD9B2">IN</th>
                                            <th style="text-align:center;vertical-align:middle;background-color:#BCD9B2">OUT</th>
                                            <th style="text-align:center;vertical-align:middle;background-color:#BCD9B2">IN</th>
                                            <th style="text-align:center;vertical-align:middle;background-color:#BCD9B2">OUT</th>
                                            <th style="text-align:center;vertical-align:middle;background-color:#ADE3DF">IN</th>
                                            <th style="text-align:center;vertical-align:middle;background-color:#ADE3DF">OUT</th>
                                            <th style="text-align:center;vertical-align:middle;background-color:#ADE3DF">IN</th>
                                            <th style="text-align:center;vertical-align:middle;background-color:#ADE3DF">OUT</th>
                                            <th style="text-align:center;vertical-align:middle;background-color:#ADE3DF">IN</th>
                                            <th style="text-align:center;vertical-align:middle;background-color:#ADE3DF">OUT</th>
                                            <th style="text-align:center;vertical-align:middle;background-color:#ADE3DF">IN</th>
                                            <th style="text-align:center;vertical-align:middle;background-color:#ADE3DF">OUT</th>
                                        </tr>
                                    </thead>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
        </div>
        <div class="tab-pane fade" id="report_pending" role="tabpanel" aria-labelledby="profile-tab">
            <div class="col-md-12 col-xl-12">
                <div class="card">
                    <div class="card-header">
                        <span class="card-title"><b>Quotations Report Pending In Out</b></span>
                    </div>
                    <div class="card-body">
                        <div class="col-md-12 col-xl-12">
                            <div class="row d-flex justify-content-between">
                                <div class="col-md-8 col-xl-8 pb-3">
                                    <div class="row">
                                        <div class="col-md-2 col-xl-2 pb-3">
                                            <select id="pendinginout_department" class="form-control">
                                            </select>
                                        </div>
                                        <div class="col-md-2 col-xl-3 pb-3">
                                            <input type="month" id="pendinginout_month_first" class="form-control" />
                                        </div>
                                        <div class="col-md-2 col-xl-3 pb-3">
                                            <input type="month" id="pendinginout_month_last" class="form-control" />
                                        </div>
                                        <div class="col-md-3 col-xl-3 pb-3">
                                            <button type="button" id="btnpendinginout_OK" class="btn btn-primary form-control">OK</button>                                       
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-2 col-xl-2 pb-3">
                                    <button type="button" id="export_pendinginout" class="btn btn-success form-control">Export</button>
                                </div>
                            </div>
                         </div>
                     </div>
                     <div class="col-md-12 col-xl-12">
                        <ul class="nav nav-tabs pl-2 pb-2" id="mysubTab" role="tablist">
                            <li class="nav-item" role="presentation">
                                <a class="nav-link active" id="report_pending-department-tab" data-toggle="tab" href="#report_pending_department" role="tab" aria-controls="report_pending_department" aria-selected="true"><b>Department</b></a>
                            </li>
                            <li class="nav-item" role="presentation">
                                <a class="nav-link" id="report_pending-sale-tab" data-toggle="tab" href="#report_pending_sale" role="tab" aria-controls="report_pending_sale" aria-selected="false"><b>Sale</b></a>
                            </li>
                        </ul>
                    </div>
                    <div class="tab-content container-fluid" id="mysubTabContent">
                        <div class="tab-pane fade" id="report_pending_department" role="tabpanel">
                            <div class="col-md-12 col-xl-12">
                                <table id="table_pendinginout_department" class="table-xl cell-border table-dark table-bordered display responsive nowrap" style="width:100%">
                                    <thead style="color:black;background-color:#2F75B5">
                                        <tr>
                                            <th style="text-align:center;background-color:#EFF5EC">Department</th>
                                            <th style="text-align:center;background-color:#EFF5EC">Product Type</th>
                                            <th style="text-align:center;background-color:#C7D0C4">Type</th>
                                            <th style="text-align:center;background-color:#BCD9B2">Brand</th>
                                            <th style="text-align:center;background-color:#ADE3DF">IN (MB)</th>
                                            <th style="text-align:center;background-color:#ADE3DF">OUT (MB)</th>
                                            <th style="text-align:center;background-color:#ADE3DF">Pending (MB)</th>
                                        </tr>                                   
                                    </thead>
                                    <tbody></tbody>
                                </table>
                            </div>
                        </div>
                         <div class="tab-pane fade" id="report_pending_sale" role="tabpanel" aria-labelledby="profile-tab">
                            <div class="col-md-12 col-xl-12">
                                <table id="table_pendinginout_sale" class="table-xl cell-border table-dark table-bordered display responsive nowrap" style="width:100%">
                                    <thead style="color:black;background-color:#2F75B5">
                                        <tr>
                                            <th style="text-align:center;background-color:#EFF5EC">Department</th>
                                            <th style="text-align:center;background-color:#EFF5EC">Sale Name</th>
                                            <th style="text-align:center;background-color:#EFF5EC">Product Type</th>
                                            <th style="text-align:center;background-color:#C7D0C4">Type</th>
                                            <th style="text-align:center;background-color:#BCD9B2">Brand</th>
                                            <th style="text-align:center;background-color:#ADE3DF">IN (MB)</th>
                                            <th style="text-align:center;background-color:#ADE3DF">OUT (MB)</th>
                                            <th style="text-align:center;background-color:#ADE3DF">Pending (MB)</th>
                                        </tr>                                   
                                    </thead>
                                    <tbody></tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>                
             </div> 
        </div>
        <div class="tab-pane fade" id="report_year" role="tabpanel" aria-labelledby="profile-tab">
            <div class="col-md-12 col-xl-12">
                <div class="card">
                    <div class="card-header">
                        <span class="card-title"><b>Quotations Report Year</b></span>
                    </div>
                    <div class="card-body">
                        <div class="col-md-12 col-xl-12">
                            <div class="row d-flex justify-content-between">
                                <div class="col-md-6 col-xl-6 pb-3">
                                    <div class="row">
                                        <div class="col-md-4 col-xl-4 pb-3">
                                            <select id="year_department" class="form-control">
                                            </select>
                                        </div>
                                        <div class="col-md-4 col-xl-4 pb-3">
                                            <select id="year_year" class="form-control">
                                            </select>
                                        </div>
                                        <div class="col-md-3 col-xl-3 pb-3">
                                            <button type="button" id="btnyear_OK" class="btn btn-primary form-control">OK</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-12" id="chkGroup_year" hidden>
                            <div class="form-group row">
                                <div class="col-12">
                                    <div class="row">
                                        <div class="col-md-2 col-xl-2">
                                            <input type="checkbox" id="chkProject_year" />
                                            <label>Project</label>
                                        </div>
                                        <div class="col-md-2 col-xl-2">
                                            <input type="checkbox" id="chkProduct_year" />
                                            <label>Product</label>
                                        </div>
                                        <div class="col-md-2 col-xl-2">
                                            <input type="checkbox" id="chkService_year" />
                                            <label>Service</label>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-2 col-xl-2">
                                            <input type="checkbox" id="chkWon_year" />
                                            <label>Won</label>
                                        </div>
                                        <div class="col-md-2 col-xl-2">
                                            <input type="checkbox" id="chkLoss_year" />
                                            <label>Loss</label>
                                        </div>
                                        <div class="col-md-2 col-xl-2">
                                            <input type="checkbox" id="chkNogo_year" />
                                            <label>No go</label>
                                        </div>
                                        <div class="col-md-2 col-xl-2">
                                            <input type="checkbox" id="chkPending_year" />
                                            <label>Pending</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12 col-xl-12">
                            <table id="table_year" class="table-xl cell-border  table-dark  table-bordered display responsive nowrap " style="width:100%">
                                <thead style="color:black;background-color:#71C6F7">
                                    <tr>
                                        <th rowspan="4" style="text-align:center;vertical-align:middle;">Area Sales</th>
                                        <th colspan="2" style="text-align:center;vertical-align:middle;">Quotation</th>
                                        <th colspan="30" style="text-align:center;vertical-align:middle;">Description</th>
                                        <th colspan="32" style="text-align:center;vertical-align:middle;">Status Quotation</th>
                                    </tr>
                                    <tr>
                                        <th rowspan="3" style="text-align:center;vertical-align:middle;">Total Quo.</th>
                                        <th rowspan="3" style="text-align:center;vertical-align:middle;">Total MB</th>
                                        <th colspan="10" style="text-align:center;vertical-align:middle;">Project</th>
                                        <th colspan="10" style="text-align:center;vertical-align:middle;">Product</th>
                                        <th colspan="10" style="text-align:center;vertical-align:middle;">Service</th>
                                        <th colspan="8" style="text-align:center;vertical-align:middle;">Won</th>
                                        <th colspan="8" style="text-align:center;vertical-align:middle;">Loss</th>
                                        <th colspan="8" style="text-align:center;vertical-align:middle;">No go</th>
                                        <th colspan="8" style="text-align:center;vertical-align:middle;">Pending</th>
                                    </tr>
                                    <tr>
                                        <th colspan="2" style="text-align:center;vertical-align:middle;">Won</th>
                                        <th colspan="2" style="text-align:center;vertical-align:middle;">Loss</th>
                                        <th colspan="2" style="text-align:center;vertical-align:middle;">No go</th>
                                        <th colspan="2" style="text-align:center;vertical-align:middle;">Pending</th>
                                        <th rowspan="2" style="text-align:center;vertical-align:middle;">Quo.</th>
                                        <th rowspan="2" style="text-align:center;vertical-align:middle;">MB</th>

                                        <th colspan="2" style="text-align:center;vertical-align:middle;">Won</th>
                                        <th colspan="2" style="text-align:center;vertical-align:middle;">Loss</th>
                                        <th colspan="2" style="text-align:center;vertical-align:middle;">No go</th>
                                        <th colspan="2" style="text-align:center;vertical-align:middle;">Pending</th>
                                        <th rowspan="2" style="text-align:center;vertical-align:middle;">Quo.</th>
                                        <th rowspan="2" style="text-align:center;vertical-align:middle;">MB</th>

                                        <th colspan="2" style="text-align:center;vertical-align:middle;">Won</th>
                                        <th colspan="2" style="text-align:center;vertical-align:middle;">Loss</th>
                                        <th colspan="2" style="text-align:center;vertical-align:middle;">No go</th>
                                        <th colspan="2" style="text-align:center;vertical-align:middle;">Pending</th>
                                        <th rowspan="2" style="text-align:center;vertical-align:middle;">Quo.</th>
                                        <th rowspan="2" style="text-align:center;vertical-align:middle;">MB</th>

                                        <th colspan="2" style="text-align:center;vertical-align:middle;">Project</th>
                                        <th colspan="2" style="text-align:center;vertical-align:middle;">Product</th>
                                        <th colspan="2" style="text-align:center;vertical-align:middle;">Service</th>
                                        <th rowspan="2" style="text-align:center;vertical-align:middle;">Quo.</th>
                                        <th rowspan="2" style="text-align:center;vertical-align:middle;">MB</th>

                                        <th colspan="2" style="text-align:center;vertical-align:middle;">Project</th>
                                        <th colspan="2" style="text-align:center;vertical-align:middle;">Product</th>
                                        <th colspan="2" style="text-align:center;vertical-align:middle;">Service</th>
                                        <th rowspan="2" style="text-align:center;vertical-align:middle;">Quo.</th>
                                        <th rowspan="2" style="text-align:center;vertical-align:middle;">MB</th>

                                        <th colspan="2" style="text-align:center;vertical-align:middle;">Project</th>
                                        <th colspan="2" style="text-align:center;vertical-align:middle;">Product</th>
                                        <th colspan="2" style="text-align:center;vertical-align:middle;">Service</th>
                                        <th rowspan="2" style="text-align:center;vertical-align:middle;">Quo.</th>
                                        <th rowspan="2" style="text-align:center;vertical-align:middle;">MB</th>

                                        <th colspan="2" style="text-align:center;vertical-align:middle;">Project</th>
                                        <th colspan="2" style="text-align:center;vertical-align:middle;">Product</th>
                                        <th colspan="2" style="text-align:center;vertical-align:middle;">Service</th>
                                        <th rowspan="2" style="text-align:center;vertical-align:middle;">Quo.</th>
                                        <th rowspan="2" style="text-align:center;vertical-align:middle;">MB</th>
                                    </tr>
                                    <tr>
                                        <th style="text-align:center;vertical-align:middle;">Quo.</th>
                                        <th style="text-align:center;vertical-align:middle;">MB</th>
                                        <th style="text-align:center;vertical-align:middle;">Quo.</th>
                                        <th style="text-align:center;vertical-align:middle;">MB</th>
                                        <th style="text-align:center;vertical-align:middle;">Quo.</th>
                                        <th style="text-align:center;vertical-align:middle;">MB</th>
                                        <th style="text-align:center;vertical-align:middle;">Quo.</th>
                                        <th style="text-align:center;vertical-align:middle;">MB</th>

                                        <th style="text-align:center;vertical-align:middle;">Quo.</th>
                                        <th style="text-align:center;vertical-align:middle;">MB</th>
                                        <th style="text-align:center;vertical-align:middle;">Quo.</th>
                                        <th style="text-align:center;vertical-align:middle;">MB</th>
                                        <th style="text-align:center;vertical-align:middle;">Quo.</th>
                                        <th style="text-align:center;vertical-align:middle;">MB</th>
                                        <th style="text-align:center;vertical-align:middle;">Quo.</th>
                                        <th style="text-align:center;vertical-align:middle;">MB</th>

                                        <th style="text-align:center;vertical-align:middle;">Quo.</th>
                                        <th style="text-align:center;vertical-align:middle;">MB</th>
                                        <th style="text-align:center;vertical-align:middle;">Quo.</th>
                                        <th style="text-align:center;vertical-align:middle;">MB</th>
                                        <th style="text-align:center;vertical-align:middle;">Quo.</th>
                                        <th style="text-align:center;vertical-align:middle;">MB</th>
                                        <th style="text-align:center;vertical-align:middle;">Quo.</th>
                                        <th style="text-align:center;vertical-align:middle;">MB</th>

                                        <th style="text-align:center;vertical-align:middle;">Quo.</th>
                                        <th style="text-align:center;vertical-align:middle;">MB</th>
                                        <th style="text-align:center;vertical-align:middle;">Quo.</th>
                                        <th style="text-align:center;vertical-align:middle;">MB</th>
                                        <th style="text-align:center;vertical-align:middle;">Quo.</th>
                                        <th style="text-align:center;vertical-align:middle;">MB</th>

                                        <th style="text-align:center;vertical-align:middle;">Quo.</th>
                                        <th style="text-align:center;vertical-align:middle;">MB</th>
                                        <th style="text-align:center;vertical-align:middle;">Quo.</th>
                                        <th style="text-align:center;vertical-align:middle;">MB</th>
                                        <th style="text-align:center;vertical-align:middle;">Quo.</th>
                                        <th style="text-align:center;vertical-align:middle;">MB</th>

                                        <th style="text-align:center;vertical-align:middle;">Quo.</th>
                                        <th style="text-align:center;vertical-align:middle;">MB</th>
                                        <th style="text-align:center;vertical-align:middle;">Quo.</th>
                                        <th style="text-align:center;vertical-align:middle;">MB</th>
                                        <th style="text-align:center;vertical-align:middle;">Quo.</th>
                                        <th style="text-align:center;vertical-align:middle;">MB</th>

                                        <th style="text-align:center;vertical-align:middle;">Quo.</th>
                                        <th style="text-align:center;vertical-align:middle;">MB</th>
                                        <th style="text-align:center;vertical-align:middle;">Quo.</th>
                                        <th style="text-align:center;vertical-align:middle;">MB</th>
                                        <th style="text-align:center;vertical-align:middle;">Quo.</th>
                                        <th style="text-align:center;vertical-align:middle;">MB</th>
                                    </tr>
                                </thead>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="tab-pane fade" id="report_status" role="tabpanel" aria-labelledby="profile-tab">
            <div class="col-md-12 col-xl-12">
                <div class="card">
                    <div class="card-header">
                        <span class="card-title"><b>Quotations Report Year</b></span>
                    </div>
                    <div class="card-body">
                        <div class="col-md-12 col-xl-12">
                            <div class="row d-flex justify-content-between">
                                <div class="col-md-10 col-xl-10 pb-3">
                                    <div class="row">
                                        <div class="col-md-2 col-xl-2 pb-3">
                                            <select id="status_year" class="form-control">
                                            </select>
                                        </div>
                                        <div class="col-md-3 col-xl-3 pb-3">
                                            <select id="status_department" class="form-control">
                                            </select>
                                        </div>
                                        <div class="col-md-3 col-xl-3 pb-3">
                                            <select id="status_sale" class="form-control">
                                            </select>
                                        </div>
                                        <div class="col-md-3 col-xl-3 pb-3">
                                            <button type="button" id="btnstatus_OK" class="btn btn-primary form-control">OK</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12 col-xl-12">
                            <table id="table_status" class="table-xl cell-border  table-dark  table-bordered display responsive nowrap " style="width:100%">
                                <thead style="color:black;background-color:#2F75B5">
                                    <tr>
                                        <th style="text-align:center;vertical-align:middle;background-color:#E7E6E6">No.</th>
                                        <th style="text-align:center;background-color:#CDCDCD">Sale Name</th>
                                        <th style="text-align:center;background-color:#31A1C4">End User</th>
                                        <th style="text-align:center;background-color:#31A1C4">Project Name</th>
                                        <th style="text-align:center;background-color:#CBE5F7">IN (MB)</th>
                                        <th style="text-align:center;background-color:#CBE5F7">OUT (MB)</th>
                                    </tr>
                                </thead>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts
{
<script type="text/javascript">
    var DataPending_Department;
    var DataPending_Sale;
    var Departments = [];
    var Years = [];
    var Sales = [];
    var columnQ1 = [2,3,4,5,6,7];
    var columnQ2 = [10,11,12,13,14,15];
    var columnQ3 = [18,19,20,21,22,23];
    var columnQ4 = [26,27,28,29,30,31];
    var temp_dataset_quarter = [];
    var hide_column = columnQ1.concat(columnQ2).concat(columnQ3).concat(columnQ4);

    var department_columnProject = [4,5,6,7,8,9,10,11];
    var department_columnProduct = [14,15,16,17,18,19,20,21];
    var department_columnService = [24,25,26,27,28,29,30,31];
    var department_columnWon = [34,35,36,37,38,39];
    var department_columnLoss = [42,43,44,45,46,47];
    var department_columnNogo = [50,51,52,53,54,55];
    var department_columnPending = [58,59,60,61,62,63];
    var temp_dataset_department = [];
    var hide_column_department = department_columnProject.
                                    concat(department_columnProduct).
                                    concat(department_columnService).
                                    concat(department_columnWon).
                                    concat(department_columnLoss).
                                    concat(department_columnNogo).
                                    concat(department_columnPending);

    var year_columnProject = [3,4,5,6,7,8,9,10];
    var year_columnProduct = [13,14,15,16,17,18,19,20];
    var year_columnService = [23,24,25,26,27,28,29,30];
    var year_columnWon = [33,34,35,36,37,38];
    var year_columnLoss = [41,42,43,44,45,46];
    var year_columnNogo = [49,50,51,52,53,54];
    var year_columnPending = [57,58,59,60,61,62];
    var temp_dataset_year = [];
    var hide_column_year = year_columnProject.
                                    concat(year_columnProduct).
                                    concat(year_columnService).
                                    concat(year_columnWon).
                                    concat(year_columnLoss).
                                    concat(year_columnNogo).
                                    concat(year_columnPending);

    $(document).ready(function () {
        init();
        document.getElementById("table_department").hidden = true;
        document.getElementById("table_quarter").hidden = true;
        document.getElementById("table_year").hidden = true;
        document.getElementById("table_status").hidden = true;
        document.getElementById("table_pendinginout_department").hidden = true;
        document.getElementById("table_pendinginout_sale").hidden = true;
        var today = new Date().toISOString().substring(0,7);
        document.getElementById("month_first").value = today;
        document.getElementById("month_last").value = today;
    });

    $('#btnOK').on('click', function () {
        document.getElementById("table_department").hidden = true;
        document.getElementById("chkGroup_department").hidden = false;
        var department = document.getElementById("department").value;
        var month_first = document.getElementById("month_first").value;
        var month_last = document.getElementById("month_last").value;
            $.ajax({
            url: '@Url.Action("GetReportDepartment", "QuotationReport")',
            type: "post",
            contentType: 'application/x-www-form-urlencoded',
            data: {
                department, month_first,month_last
            },
            success: function (response) {
                document.getElementById("table_department").hidden = false;
                var datas = response;
                var dataSet = [];
                for (var i = 0; i < datas.length; i++) {
                    var data = [
                               datas[i].department,
                               datas[i].sale,
                               datas[i].quo_cnt,
                               datas[i].quo_mb,
                               datas[i].project_won_cnt,
                               datas[i].project_won_mb,
                               datas[i].project_lost_cnt,
                               datas[i].project_lost_mb,
                               datas[i].project_nogo_cnt,
                               datas[i].project_nogo_mb,
                               datas[i].project_pending_cnt,
                               datas[i].project_pending_mb,
                               datas[i].project_cnt,
                               datas[i].project_mb,
                               datas[i].product_won_cnt,
                               datas[i].product_won_mb,
                               datas[i].product_lost_cnt,
                               datas[i].product_lost_mb,
                               datas[i].product_nogo_cnt,
                               datas[i].product_nogo_mb,
                               datas[i].product_pending_cnt,
                               datas[i].product_pending_mb,
                               datas[i].product_cnt,
                               datas[i].product_mb,
                               datas[i].service_won_cnt,
                               datas[i].service_won_mb,
                               datas[i].service_lost_cnt,
                               datas[i].service_lost_mb,
                               datas[i].service_nogo_cnt,
                               datas[i].service_nogo_mb,
                               datas[i].service_pending_cnt,
                               datas[i].service_pending_mb,
                               datas[i].service_cnt,
                               datas[i].service_mb,
                               datas[i].won_project_cnt,
                               datas[i].won_project_mb,
                               datas[i].won_product_cnt,
                               datas[i].won_product_mb,
                               datas[i].won_service_cnt,
                               datas[i].won_service_mb,
                               datas[i].won_quo_cnt,
                               datas[i].won_mb,
                               datas[i].lost_project_cnt,
                               datas[i].lost_project_mb,
                               datas[i].lost_product_cnt,
                               datas[i].lost_product_mb,
                               datas[i].lost_service_cnt,
                               datas[i].lost_service_mb,
                               datas[i].loss_quo_cnt,
                               datas[i].loss_mb,
                               datas[i].nogo_project_cnt,
                               datas[i].nogo_project_mb,
                               datas[i].nogo_product_cnt,
                               datas[i].nogo_product_mb,
                               datas[i].nogo_service_cnt,
                               datas[i].nogo_service_mb,
                               datas[i].nogo_quo_cnt,
                               datas[i].nogo_mb,
                               datas[i].pending_project_cnt,
                               datas[i].pending_project_mb,
                               datas[i].pending_product_cnt,
                               datas[i].pending_product_mb,
                               datas[i].pending_service_cnt,
                               datas[i].pending_service_mb,
                               datas[i].pending_quo_cnt,
                               datas[i].pending_mb];

                           dataSet.push(data);
                       }
                       temp_dataset_department = dataSet;
                       tableDepartment(dataSet);
                   }
    });
           });
           $('#btnquarter_OK').on('click', function () {
                document.getElementById("table_quarter").hidden = false;
                document.getElementById("chkGroup").hidden = false;
                var department = document.getElementById("quarter_department").value;
                var year = document.getElementById("quarter_year").value;
                $.ajax({
                   url: '@Url.Action("GetReportQuarter", "QuotationReport")',
                   type: "post",
                   contentType: 'application/x-www-form-urlencoded',
                   data: {
                       department, year
                   },
                   success: function (response) {

                       var datas = response;
                       var dataSet = [];
                       for (var i = 0; i < datas.length; i++) {
                           var data = [
                               datas[i].department,
                               datas[i].sale,
                               datas[i].jan_in,
                               datas[i].jan_out,
                               datas[i].feb_in,
                               datas[i].feb_out,
                               datas[i].mar_in,
                               datas[i].mar_out,
                               datas[i].sum_in_q1,
                               datas[i].sum_out_q1,
                               datas[i].apr_in,
                               datas[i].apr_out,
                               datas[i].may_in,
                               datas[i].may_out,
                               datas[i].jun_in,
                               datas[i].jun_out,
                               datas[i].sum_in_q2,
                               datas[i].sum_out_q2,
                               datas[i].jul_in,
                               datas[i].jul_out,
                               datas[i].aug_in,
                               datas[i].aug_out,
                               datas[i].sep_in,
                               datas[i].sep_out,
                               datas[i].sum_in_q3,
                               datas[i].sum_out_q3,
                               datas[i].oct_in,
                               datas[i].oct_out,
                               datas[i].nov_in,
                               datas[i].nov_out,
                               datas[i].dec_in,
                               datas[i].dec_out,
                               datas[i].sum_in_q4,
                               datas[i].sum_out_q4
                               ];

                           dataSet.push(data);
                       }
                       temp_dataset_quarter = dataSet;
                       tableQuarter(dataSet);
                   }
                });
           });
           $('#export_department').on('click',function(){
               var department = document.getElementById("department").value;
               var month_first = document.getElementById("month_first").value;
               var month_last = document.getElementById("month_last").value;
               location.href = '@Url.Action("DownloadXlsxReportDepartment", "QuotationReport")?department='+department+'&month_first='+month_first+'&month_last='+month_last;
           });
           $('#export_quarter').on('click',function(){
               var department = document.getElementById("quarter_department").value;
               var year = document.getElementById("quarter_year").value;
               location.href = '@Url.Action("DownloadXlsxReportQuarter", "QuotationReport")?department='+department+'&year='+year;
           });
           $('#chkQ1').on('change',function(){
               hide_column_quarter();
           });
            $('#chkQ2').on('change',function(){
               hide_column_quarter();
           });
            $('#chkQ3').on('change',function(){
               hide_column_quarter();
           });
            $('#chkQ4').on('change',function(){
               hide_column_quarter();
           });

           $('#chkProject_department').on('change',function(){
               hide_columnDepartment();
           });
            $('#chkProduct_department').on('change',function(){
               hide_columnDepartment();
           });
            $('#chkService_department').on('change',function(){
               hide_columnDepartment();
           });
            $('#chkWon_department').on('change',function(){
               hide_columnDepartment();
           });
            $('#chkLoss_department').on('change',function(){
               hide_columnDepartment();
           });
            $('#chkNogo_department').on('change',function(){
               hide_columnDepartment();
           });
            $('#chkPending_department').on('change',function(){
               hide_columnDepartment();
           });

           $('#chkProject_year').on('change',function(){
               hide_columnYear();
           });
            $('#chkProduct_year').on('change',function(){
               hide_columnYear();
           });
            $('#chkService_year').on('change',function(){
               hide_columnYear();
           });
            $('#chkWon_year').on('change',function(){
               hide_columnYear();
           });
            $('#chkLoss_year').on('change',function(){
               hide_columnYear();
           });
            $('#chkNogo_year').on('change',function(){
               hide_columnYear();
           });
            $('#chkPending_year').on('change',function(){
               hide_columnYear();
           });


           $('#report_year-tab').on('click',function(){

                $('#year_department').empty();
                var selectQuarterDepartment = document.getElementById('year_department');
                var n = 0;  // Check Department All 
                if (Departments.length > 1){
                    n=1;
                }
                for (var i = n, l = Departments.length; i < l; i++) {
                    var option = Departments[i];
                    selectQuarterDepartment.options.add(new Option(option.text, option.value, option.selected));
                }
                document.getElementById('year_department').selectedIndex = 0;

                $('#year_year').empty();
                var selectQuarterYear = document.getElementById('year_year');
                for (var i = 0, l = Years.length; i < l; i++) {
                    var option = Years[i];
                    selectQuarterYear.options.add(new Option(option.text, option.value, option.selected));
                }
                document.getElementById('year_year').selectedIndex = 0;
           });

           $('#btnyear_OK').on('click',function(){
               document.getElementById("table_year").hidden = true;
               document.getElementById("chkGroup_year").hidden = false;
               var department = document.getElementById("year_department").value;
               var year = document.getElementById("year_year").value;
               $.ajax({
                   url: '@Url.Action("GetReportYear", "QuotationReport")',
                   type: "post",
                   contentType: 'application/x-www-form-urlencoded',
                   data: {
                       department, year
                   },
                   success: function (response) {
                       document.getElementById("table_year").hidden = false;
                       var datas = response;
                       var dataSet = [];
                       var months = ["","January","February","March","April","May","June","July","August","September","October","November","December"];

                       for (var i = 0; i < datas.length; i++) {
                           var month = datas[i].month;
                           if (i < datas.length-1){
                                month = months[(parseInt(datas[i].month.split("-")[1]))];
                           }
                           var data = [
                               month,
                               datas[i].quo_cnt,
                               datas[i].quo_mb,
                               datas[i].project_won_cnt,
                               datas[i].project_won_mb,
                               datas[i].project_lost_cnt,
                               datas[i].project_lost_mb,
                               datas[i].project_nogo_cnt,
                               datas[i].project_nogo_mb,
                               datas[i].project_pending_cnt,
                               datas[i].project_pending_mb,
                               datas[i].project_cnt,
                               datas[i].project_mb,
                               datas[i].product_won_cnt,
                               datas[i].product_won_mb,
                               datas[i].product_lost_cnt,
                               datas[i].product_lost_mb,
                               datas[i].product_nogo_cnt,
                               datas[i].product_nogo_mb,
                               datas[i].product_pending_cnt,
                               datas[i].product_pending_mb,
                               datas[i].product_cnt,
                               datas[i].product_mb,
                               datas[i].service_won_cnt,
                               datas[i].service_won_mb,
                               datas[i].service_lost_cnt,
                               datas[i].service_lost_mb,
                               datas[i].service_nogo_cnt,
                               datas[i].service_nogo_mb,
                               datas[i].service_pending_cnt,
                               datas[i].service_pending_mb,
                               datas[i].service_cnt,
                               datas[i].service_mb,
                               datas[i].won_project_cnt,
                               datas[i].won_project_mb,
                               datas[i].won_product_cnt,
                               datas[i].won_product_mb,
                               datas[i].won_service_cnt,
                               datas[i].won_service_mb,
                               datas[i].won_quo_cnt,
                               datas[i].won_mb,
                               datas[i].lost_project_cnt,
                               datas[i].lost_project_mb,
                               datas[i].lost_product_cnt,
                               datas[i].lost_product_mb,
                               datas[i].lost_service_cnt,
                               datas[i].lost_service_mb,
                               datas[i].loss_quo_cnt,
                               datas[i].loss_mb,
                               datas[i].nogo_project_cnt,
                               datas[i].nogo_project_mb,
                               datas[i].nogo_product_cnt,
                               datas[i].nogo_product_mb,
                               datas[i].nogo_service_cnt,
                               datas[i].nogo_service_mb,
                               datas[i].nogo_quo_cnt,
                               datas[i].nogo_mb,
                               datas[i].pending_project_cnt,
                               datas[i].pending_project_mb,
                               datas[i].pending_product_cnt,
                               datas[i].pending_product_mb,
                               datas[i].pending_service_cnt,
                               datas[i].pending_service_mb,
                               datas[i].pending_quo_cnt,
                               datas[i].pending_mb];

                           dataSet.push(data);
                       }
                       temp_dataset_year = dataSet;
                       tableYear(dataSet);
                   }
               });
           });

            $('#report_status-tab').on('click',function(){

                $('#status_department').empty();
                var selectQuarterDepartment = document.getElementById('status_department');
                for (var i = 0, l = Departments.length; i < l; i++) {
                    var option = Departments[i];
                    selectQuarterDepartment.options.add(new Option(option.text, option.value, option.selected));
                }
                document.getElementById('status_department').selectedIndex = 0;

                $('#status_year').empty();
                var selectQuarterYear = document.getElementById('status_year');
                for (var i = 0, l = Years.length; i < l; i++) {
                    var option = Years[i];
                    selectQuarterYear.options.add(new Option(option.text, option.value, option.selected));
                }
                document.getElementById('status_year').selectedIndex = 0;

                $('#status_sale').empty();
                var selectSale = document.getElementById('status_sale');
                selectSale.options.add(new Option("ALL", "ALL", null));
                document.getElementById('status_sale').selectedIndex = 0;
           });

            $('#status_department').on('focus change',function(){
               var department = document.getElementById("status_department").value;
               $.ajax({
                   url: '@Url.Action("GetSales", "QuotationReport")',
                   type: "post",
                   contentType: 'application/x-www-form-urlencoded',
                   data: {
                       department
                   },
                   success: function (response) {
                       Sales = add_sale(response);

                       $('#status_sale').empty();
                        var selectsale = document.getElementById('status_sale');
                        for (var i = 0, l = Sales.length; i < l; i++) {
                            var option = Sales[i];
                            selectsale.options.add(new Option(option.text, option.value, option.selected));
                        }
                        document.getElementById('status_sale').selectedIndex = 0;
                   }
                });
            });

            $('#btnstatus_OK').on('click',function(){
                document.getElementById("table_status").hidden = false;
                var year = document.getElementById("status_year").value;
                var department = document.getElementById("status_department").value;
                var sale = document.getElementById("status_sale").value;
                $.ajax({
                   url: '@Url.Action("GetReportStatus", "QuotationReport")',
                   type: "post",
                   contentType: 'application/x-www-form-urlencoded',
                   data: {
                       year,department,sale
                   },
                   success: function (response) {
                       var datas = response;
                       var dataSet = [];
                       for (var i = 0; i < datas.length; i++) {
                           var data = [
                               datas[i].no,
                               datas[i].sale_name,
                               datas[i].enduser,
                               datas[i].project_name,
                               datas[i].status_in,
                               datas[i].status_out];

                           dataSet.push(data);
                       }
                       tableStatus(dataSet);
                   }
                });
            });

            $('#report_pending-tab').on('click',function(){
                //set today
                var today = new Date().toISOString().substring(0,7);
                document.getElementById("pendinginout_month_first").value = today;
                document.getElementById("pendinginout_month_last").value = today;

                //set select department
                $('#pendinginout_department').empty();
                var selectQuarterDepartment = document.getElementById('pendinginout_department');
                var n = 0;  // Check Department All 
                if (Departments.length > 1){
                    n=1;
                }
                for (var i = n, l = Departments.length; i < l; i++) {
                    var option = Departments[i];
                    selectQuarterDepartment.options.add(new Option(option.text, option.value, option.selected));
                }
                document.getElementById('pendinginout_department').selectedIndex = 0;
            });

            $('#btnpendinginout_OK').on('click', function(){
               document.getElementById("table_pendinginout_department").hidden = false;
               document.getElementById("table_pendinginout_sale").hidden = false;
              // $('#report_pending_department').tab('show');
               //cal api
               var department = document.getElementById("pendinginout_department").value;
               var month_first = document.getElementById("pendinginout_month_first").value;
               var month_last = document.getElementById("pendinginout_month_last").value;
               $.ajax({
                   url: '@Url.Action("GetReportPendingInOut", "QuotationReport")',
                   type: "post",
                   contentType: 'application/x-www-form-urlencoded',
                   data: {
                       department,month_first,month_last
                   },
                   success: function (response) {
                       DataPending_Sale = response.sale;
                       DataPending_Department = response.department;
                       
                       var datas_department = DataPending_Department;
                       var dataSet_department = [];
                       for (var i = 0; i < datas_department.length; i++) {
                           var data = [
                               datas_department[i].department,
                               datas_department[i].product_type,
                               datas_department[i].type,
                               datas_department[i].brand,
                               datas_department[i].pending_in,
                               datas_department[i].pending_out,
                               datas_department[i].pending];

                           dataSet_department.push(data);
                       }
                       tablePendingInOutDepartment(dataSet_department);
                   }                 
                });
                 
            });

            $('#report_pending-sale-tab').on('click',function(){
                $('#report_pending_department').tab('dispose');
                var datas = DataPending_Sale;
                var dataSet = [] ;
                for (var i = 0; i < datas.length; i++) {
                           var data = [
                               datas[i].department,
                               datas[i].sale_name,
                               datas[i].product_type,
                               datas[i].type,
                               datas[i].brand,
                               datas[i].pending_in,
                               datas[i].pending_out,
                               datas[i].pending];

                           dataSet.push(data);
                       }
                tablePendingInOutSale(dataSet);
            });
            $('#report_pending-department-tab').on('click',function(){
                var datas_department = DataPending_Department;
                var dataSet_department = [];
                       for (var i = 0; i < datas_department.length; i++) {
                           var data = [
                               datas_department[i].department,
                               datas_department[i].product_type,
                               datas_department[i].type,
                               datas_department[i].brand,
                               datas_department[i].pending_in,
                               datas_department[i].pending_out,
                               datas_department[i].pending];

                           dataSet_department.push(data);
                       }
                       tablePendingInOutDepartment(dataSet_department);
            });
            $('#export_pendinginout').on('click',function(){
               var department = document.getElementById("pendinginout_department").value;
               var month_first = document.getElementById("pendinginout_month_first").value;
               var month_last = document.getElementById("pendinginout_month_last").value;
               location.href = '@Url.Action("DownloadXlsxReportPendingInOut", "QuotationReport")?department='+department+'&month_first='+month_first+'&month_last='+month_last;
           });
        function init() {

               $.ajax({
                   url: '@Url.Action("GetDepartment", "QuotationReport")',
                   type: "post",
                   contentType: 'application/x-www-form-urlencoded',
                   data: {
                   },
                   success: function (response) {
                        Departments = add_department(response.departments);
                        Years = add_year(response.years);

                        $('#department').empty();
                        var selectDepartment = document.getElementById('department');
                        for (var i = 0, l = Departments.length; i < l; i++) {
                            var option = Departments[i];
                            selectDepartment.options.add(new Option(option.text, option.value, option.selected));
                        }
                        document.getElementById('department').selectedIndex = 0;

                        $('#quarter_department').empty();
                        var selectQuarterDepartment = document.getElementById('quarter_department');
                        for (var i = 0, l = Departments.length; i < l; i++) {
                            var option = Departments[i];
                            selectQuarterDepartment.options.add(new Option(option.text, option.value, option.selected));
                        }
                        document.getElementById('quarter_department').selectedIndex = 0;

                        $('#quarter_year').empty();
                        var selectQuarterYear = document.getElementById('quarter_year');
                        for (var i = 0, l = Years.length; i < l; i++) {
                            var option = Years[i];
                            selectQuarterYear.options.add(new Option(option.text, option.value, option.selected));
                        }
                        document.getElementById('quarter_year').selectedIndex = 0;
                   }
               });
        };

        var tables_department;
        function tableDepartment(dataSet) {
            setTimeout(()=>{
                if (tables_department !== undefined)
                tables_department.destroy();
                tables_department = $('#table_department').DataTable({
                data: dataSet,
                "columnDefs": [
                     {
                         "targets" : [2,3,12,13,22,23,32,33,40,41,48,49,56,57,64,65],
                         "class": "index_department",
                     },

                    {
                        "targets": "_all",
                        "className": "text-center",
                    },

                    {
                        "targets": hide_column_department,
                        "visible": false,
                        "searchable": false
                    },


                ],
                "rowCallback": function (row, data, index) {
                    if (data[0] == "Total") {
                        $('td', row).css('background-color', '#AFA095');
                        $('td', row).addClass('highlight');
                    } else if (data[0] !== "Total" && data[0].includes("Total")) {
                        $('td', row).css('background-color', '#EFE8E2');
                        $('td', row).addClass('highlight');
                    }
                },
                "paging": false,
                "searching": false,
                "bInfo": false,
                "scrollX": true,
                "ordering":false,
                "fixedColumns": true
            });

            $(tables_department.table().body()).addClass('text-dark');
            },100);
        };
        var tables_quarter;
        function tableQuarter(dataSet) {
            setTimeout(()=>{
                if (tables_quarter !== undefined)
                tables_quarter.destroy();
            tables_quarter = $('#table_quarter').DataTable({
                data: dataSet,
                "columnDefs": [
                    {
                         "targets" : [8,9,16,17,24,25,32,33],
                         "class": "index_quarter",
                    },
                    {
                        "targets": "_all",
                        "className": "text-center",
                    },
                    {
                        "targets": hide_column,
                        "visible": false,
                        "searchable": false
                    },
                ],
                "createdRow": function (row, data, index) {
                    if (data[0] == "Total") {
                        $('td', row).css('background-color', '#AFA095');
                        $('td', row).addClass('highlight');
                    } else if (data[0] !== "Total" && data[0].includes("Total")) {
                        $('td', row).css('background-color', '#EFE8E2');
                        $('td', row).addClass('highlight');
                    }
                },
                "paging": false,
                "searching": false,
                "bInfo": false,
                "scrollX": true,
            });
            $(tables_quarter.table().body()).addClass('text-dark');
            },100);
        };
        var tables_pendinginout_depatment;
        function tablePendingInOutDepartment(dataSet) {
            setTimeout(()=>{
                if (tables_pendinginout_depatment !== undefined)
                    tables_pendinginout_depatment.destroy();
                tables_pendinginout_depatment = $('#table_pendinginout_department').DataTable({
                data: dataSet,
                "columnDefs": [
                    {
                        "targets": "_all",
                        "className": "text-center",
                    },
                ],
                "createdRow": function (row, data, index) {
                    if (data[1] == "รวม") {
                        $('td', row).css('background-color', '#AFA095');
                        $('td', row).addClass('highlight');
                    }else if (data[1] !== "Total" && data[1].includes("Total")) {
                        $('td', row).css('background-color', '#EFE8E2');
                        $('td', row).addClass('highlight');
                    }
                },
                "paging": false,
                "searching": false,
                "bInfo": false,
                "scrollX": true,
                "ordering": false,
            });
            $(tables_pendinginout_depatment.table().body()).addClass('text-dark');
            },200);
        };

         var tables_pendinginout_sale;
        function tablePendingInOutSale(dataSet) {
            setTimeout(()=>{
                if (tables_pendinginout_sale !== undefined)
                    tables_pendinginout_sale.destroy();
                tables_pendinginout_sale = $('#table_pendinginout_sale').DataTable({
                data: dataSet,
                "columnDefs": [
                    {
                        "targets": "_all",
                        "className": "text-center",
                    },
                ],
                "createdRow": function (row, data, index) {
                    if (data[1] == "รวม") {
                        $('td', row).css('background-color', '#AFA095');
                        $('td', row).addClass('highlight');
                    }else if (data[1] !== "Total" && data[1].includes("Total")) {
                        $('td', row).css('background-color', '#EFE8E2');
                        $('td', row).addClass('highlight');
                    }
                },
                "paging": false,
                "searching": false,
                "bInfo": false,
                "scrollX": true,
                "ordering": false,
            });
            $(tables_pendinginout_sale.table().body()).addClass('text-dark');
            },200);
        };
        var tables_year;
        function tableYear(dataSet) {
            setTimeout(()=>{
                if (tables_year !== undefined)
                tables_year.destroy();
                tables_year = $('#table_year').DataTable({
                data: dataSet,
                "columnDefs": [
                    {
                         "targets" : [1,2,11,12,21,22,31,32,39,40,47,48,55,56,63,64],
                         "class": "index_year",
                    },
                    {
                        "targets": "_all",
                        "className": "text-center",
                    },
                    {
                        "targets": hide_column_year,
                        "visible": false,
                        "searchable": false
                    },
                ],
                    "createdRow": function (row, data, index) {
                    if (data[0] == "Total") {
                        $('td', row).css('background-color', '#AFA095');
                        $('td', row).addClass('highlight');
                    }
                },
                "paging": false,
                "searching": false,
                "bInfo": false,
                "scrollX": true,
                "ordering": false,
                "fixedColumns": true
            });
            $(tables_year.table().body()).addClass('text-dark');
            },100);
        };

        var tables_status;
        function tableStatus(dataSet) {
            setTimeout(()=>{
                if (tables_status !== undefined)
                tables_status.destroy();
                tables_status = $('#table_status').DataTable({
                data: dataSet,
                "columnDefs": [
                    {
                        "targets": [0, 1, 2, 3, 4, 5],
                        "className": "text-center",
                    },
                ],
                "createdRow": function (row, data, index) {
                    if (data[1] == "รวม") {
                        $('td', row).css('background-color', '#AFA095');
                        $('td', row).addClass('highlight');
                    }else if (data[1] !== "Total" && data[1].includes("Total")) {
                        $('td', row).css('background-color', '#EFE8E2');
                        $('td', row).addClass('highlight');
                    }
                },
                "paging": false,
                "searching": false,
                "bInfo": false,
                "scrollX": true,
                "ordering": false,
            });
            $(tables_status.table().body()).addClass('text-dark');
            },100);
        };

        function add_department(departments) {
            var data_departments = [];
            for (var i = 0; i < departments.length; i++) {
                var data =
                {
                    "text": departments[i],
                    "value": departments[i]
                }
                data_departments.push(data);
            }

            return data_departments;
        };
        function add_year(years) {
            var data_years = [];
            for (var i = 0; i < years.length; i++) {
                var data =
                {
                    "text": years[i],
                    "value": years[i]
                }
                data_years.push(data);
            }

            return data_years;
        };

        function add_sale(sales) {
            var data_sales = [];
            for (var i = 0; i < sales.length; i++) {
                var data =
                {
                    "text": sales[i],
                    "value": sales[i]
                }
                data_sales.push(data);
            }

            return data_sales;
        };
        function hide_column_quarter(){
               hide_column = [];
               var chkQ1 = document.getElementById("chkQ1").checked;
               var chkQ2 = document.getElementById("chkQ2").checked;
               var chkQ3 = document.getElementById("chkQ3").checked;
               var chkQ4 = document.getElementById("chkQ4").checked;


               if(chkQ1 == false){
                  hide_column =  hide_column.concat(columnQ1);
               }
               if(chkQ2 == false){
                   hide_column = hide_column.concat(columnQ2);
               }
               if(chkQ3 == false){
                   hide_column = hide_column.concat(columnQ3);
               }
               if(chkQ4 == false){
                  hide_column = hide_column.concat(columnQ4);
               }

               // show column
               tableQuarter(temp_dataset_quarter);
        };

        function hide_columnDepartment(){

            hide_column_department = [];
               var chkProject = document.getElementById("chkProject_department").checked;
               var chkProduct = document.getElementById("chkProduct_department").checked;
               var chkService = document.getElementById("chkService_department").checked;
               var chkWon = document.getElementById("chkWon_department").checked;
               var chkLoss = document.getElementById("chkLoss_department").checked;
               var chkNogo = document.getElementById("chkNogo_department").checked;
               var chkPending = document.getElementById("chkPending_department").checked;

               if(chkProject == false){
                  hide_column_department =  hide_column_department.concat(department_columnProject);
               }
               if(chkProduct == false){
                  hide_column_department =  hide_column_department.concat(department_columnProduct);
               }
                if(chkService == false){
                  hide_column_department =  hide_column_department.concat(department_columnService);
               }
                if(chkWon == false){
                  hide_column_department =  hide_column_department.concat(department_columnWon);
               }
                if(chkLoss == false){
                  hide_column_department =  hide_column_department.concat(department_columnLoss);
               }
                if(chkNogo == false){
                  hide_column_department =  hide_column_department.concat(department_columnNogo);
               }
                if(chkPending == false){
                  hide_column_department =  hide_column_department.concat(department_columnPending);
               }

               // show column
               tableDepartment(temp_dataset_department);
        };
        function hide_columnYear(){

            hide_column_year = [];
               var chkProject = document.getElementById("chkProject_year").checked;
               var chkProduct = document.getElementById("chkProduct_year").checked;
               var chkService = document.getElementById("chkService_year").checked;
               var chkWon = document.getElementById("chkWon_year").checked;
               var chkLoss = document.getElementById("chkLoss_year").checked;
               var chkNogo = document.getElementById("chkNogo_year").checked;
               var chkPending = document.getElementById("chkPending_year").checked;

               if(chkProject == false){
                  hide_column_year =  hide_column_year.concat(year_columnProject);
               }
               if(chkProduct == false){
                  hide_column_year =  hide_column_year.concat(year_columnProduct);
               }
                if(chkService == false){
                  hide_column_year =  hide_column_year.concat(year_columnService);
               }
                if(chkWon == false){
                  hide_column_year =  hide_column_year.concat(year_columnWon);
               }
                if(chkLoss == false){
                  hide_column_year =  hide_column_year.concat(year_columnLoss);
               }
                if(chkNogo == false){
                  hide_column_year =  hide_column_year.concat(year_columnNogo);
               }
                if(chkPending == false){
                  hide_column_year =  hide_column_year.concat(year_columnPending);
               }

               // show column
               tableYear(temp_dataset_year);
        };
</script>
}
