@model WebForecastReport.Models.MPR.Form_OvertimeModel
@{
    Layout = null;
}
<!DOCTYPE html>
<html>
<head>
    <title>Form Overtime</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/admin-lte/3.2.0/css/adminlte.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/datatables/1.10.21/css/jquery.dataTables.min.css" />
    <style>

        p {
            font-size: 16px;
            font-family: 'Angsana New';
        }

        table {
            font-size: 16px;
            font-family: 'Angsana New';
            text-wrap: none;
            margin: 0px;
            padding: 0px;
            line-height: 10px;
        }

        @*thead, th, tbody, td {
            border-color: black;
            border-width: 1px;
            border-style: solid;
            border-top-color:black;
            border-bottom-color:black;
        }*@

        tr {
            margin: 0px;
            padding: 0px;
            vertical-align: middle;
            @*border-top-color: black;
            border-bottom-color: black;*@
        }

    </style>
</head>
<body>
    <div class="container">
        <form>
            <div class="form-group row">
                <div class="col-10 text-center">
                    <p style="font-size:18px;padding-left:50px;margin:0px">บริษัทคอนโทรลอจิค จำกัด</p>
                    <p style="font-size:18px;padding-left:50px;margin:0px">Overtime Record ใบเบิกค่าทำงานล่วงเวลา</p>
                </div>
                <div class="col-2">
                    <img src="https://contrologic.co.th/web/wp-content/uploads/2020/07/contrologic-logo.png" height="50" />
                </div>
            </div>
            <div class="form-group row" style="margin:0px;">
                <div class="col-2">
                    <p>ชื่อพนักงาน</p>
                </div>
                <div class="col-4">
                    <p>@Model.employee_name.ToUpper()</p>
                </div>
                <div class="col-4 text-right">
                    <p>แผนก</p>
                </div>
                <div class="col-2">
                    <p>@Model.department</p>
                </div>
            </div>
            <div class="form-group row" style="margin:0px">
                <div class="col-2">
                    <p>เบอร์โทรศัพท์</p>
                </div>
                <div class="col-4">
                    <p>@Model.phone_number</p>
                </div>
                <div class="col-4 text-right">
                    <p>เวลาเริ่มงานปกติ</p>
                </div>
                <div class="col-2">
                    <p>08:30</p>
                </div>
            </div>
            <div class="form-group row" style="margin:0px">
                <div class="col-2">
                    <p>สำหรับงวดเดือน</p>
                </div>
                <div class="col-4">
                    <p>@Convert.ToDateTime(Model.month).ToString("MMMM yyyy").ToUpper()</p>
                </div>
            </div>
            <div class="form-group">
                <br />
            </div>

            <div class="form-group">
                <table class="table table-bordered table-sm text-center">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Day</th>
                            <th>Job</th>
                            <th>Location</th>
                            <th>Task</th>
                            <th>Start</th>
                            <th>Stop</th>
                            <th>Lunch</th>
                            <th>Break</th>
                            <th>OT 1.5</th>
                            <th>OT 3.0</th>
                        </tr>
                    </thead>
                    <tbody>
                        @for (int i = 0; i < Model.datas.Count(); i++)
                        {
                            @if (Model.datas[i].holiday == true)
                            {
                                <tr style="background-color:darkgray">
                                    <td>
                                        @Model.datas[i].date
                                    </td>
                                    <td>
                                        @Model.datas[i].day
                                    </td>
                                    <td>
                                        @Model.datas[i].job
                                    </td>
                                    <td>
                                        @Model.datas[i].location
                                    </td>
                                    <td>
                                        @Model.datas[i].task
                                    </td>
                                    <td>
                                        @Model.datas[i].start_time
                                    </td>
                                    <td>
                                        @Model.datas[i].stop_time
                                    </td>
                                    <td>
                                        @Model.datas[i].lunch
                                    </td>
                                    <td>
                                        @Model.datas[i].dinner
                                    </td>
                                    <td>
                                        @Model.datas[i].ot1_5
                                    </td>
                                    <td>
                                        @Model.datas[i].ot3_0
                                    </td>
                                </tr>
                            }
                            else if (Model.datas[i].weekend == true)
                            {
                                <tr style="background-color:lightgray">
                                    <td>
                                        @Model.datas[i].date
                                    </td>
                                    <td>
                                        @Model.datas[i].day
                                    </td>
                                    <td>
                                        @Model.datas[i].job
                                    </td>
                                    <td>
                                        @Model.datas[i].location
                                    </td>
                                    <td>
                                        @Model.datas[i].task
                                    </td>
                                    <td>
                                        @Model.datas[i].start_time
                                    </td>
                                    <td>
                                        @Model.datas[i].stop_time
                                    </td>
                                    <td>
                                        @Model.datas[i].lunch
                                    </td>
                                    <td>
                                        @Model.datas[i].dinner
                                    </td>
                                    <td>
                                        @Model.datas[i].ot1_5
                                    </td>
                                    <td>
                                        @Model.datas[i].ot3_0
                                    </td>
                                </tr>
                            }
                            else
                            {
                                <tr>
                                    <td>
                                        @Model.datas[i].date
                                    </td>
                                    <td>
                                        @Model.datas[i].day
                                    </td>
                                    <td>
                                        @Model.datas[i].job
                                    </td>
                                    <td>
                                        @Model.datas[i].location
                                    </td>
                                    <td>
                                        @Model.datas[i].task
                                    </td>
                                    <td>
                                        @Model.datas[i].start_time
                                    </td>
                                    <td>
                                        @Model.datas[i].stop_time
                                    </td>
                                    <td>
                                        @Model.datas[i].lunch
                                    </td>
                                    <td>
                                        @Model.datas[i].dinner
                                    </td>
                                    <td>
                                        @Model.datas[i].ot1_5
                                    </td>
                                    <td>
                                        @Model.datas[i].ot3_0
                                    </td>
                                </tr>
                            }

                        }
                        <tr>
                            <td colspan="9">Total</td>
                            <td>@Model.total_ot1_5</td>
                            <td>@Model.total_ot3_0</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="form-group row">
                <div class="col-1">

                </div>
                <div class="col-2" style="border-bottom: 1px solid">
                    <p style="color:white">Korakod.P</p>
                </div>
                <div class="col-1">

                </div>
                <div class="col-1">

                </div>
                <div class="col-2" style="border-bottom: 1px solid">
                    <p style="color:white">Korakod.P</p>
                </div>
                <div class="col-1">

                </div>
                <div class="col-1">

                </div>
                <div class="col-2" style="border-bottom: 1px solid">
                    <p style="color:white">Korakod.P</p>
                </div>
                <div class="col-1">

                </div>
            </div>

            <div class="form-group row">
                <div class="col-1"></div>
                <div class="col-2 text-center">
                    <p>(ผู้ควบคุมการทำงาน)</p>
                </div>
                <div class="col-2"></div>
                <div class="col-2 text-center">
                    <p>(ผู้ตรวจสอบ)</p>
                </div>
                <div class="col-2"></div>
                <div class="col-2 text-center">
                    <p>(ผู้อนุมัติ)</p>
                </div>
                <div class="col-1"></div>
            </div>

            <div class="form-group my-0 py-0 row">
                <div class="col-12">
                    <p>ADMIN</p>
                </div>
            </div>
            <div class="form-group row">
                <div class="col-4">
                    <table class="table table-bordered table-sm text-center">
                        <thead>
                            <tr>
                                <th></th>
                                <th>จำนวนชั่วโมงทำงาน</th>
                                <th>FACTOR</th>
                                <th>จำนวนเงิน</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <th></th>
                                <th>(A)</th>
                                <th>(B)</th>
                                <th>(A) * (B)</th>
                            </tr>
                            <tr>
                                <td>1</td>
                                <td>@Model.hours_normal.ToString("#.#")</td>
                                <td>1</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>2</td>
                                <td>@Model.hours_1_5.ToString("#.#")</td>
                                <td>1.5</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>3</td>
                                <td>@Model.hours_3_0.ToString("#.#")</td>
                                <td>3</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>4</td>
                                <td>เหมาจ่าย</td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>รวม</td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="col-4">

                </div>
                <div class="col-4">
                    <table class="table table-bordered table-sm text-center">
                        <thead>
                            <tr>
                                <th>NO</th>
                                <th>JOB NO.</th>
                                <th>Normal</th>
                                <th>OT 1.5</th>
                                <th>OT 3.0</th>
                            </tr>
                        </thead>
                        <tbody>
                            @for (int i = 0; i < 10; i++)
                            {
                                @if (i < Model.summary.Count())
                                {
                                    <tr>
                                        <td>@(i + 1)</td>
                                        <td>@Model.summary[i].job_id</td>
                                        <td>@Convert.ToDouble(Model.summary[i].normal.TotalHours).ToString("#.#")</td>
                                        <td>@Convert.ToDouble(Model.summary[i].ot1_5.TotalHours).ToString("#.#")</td>
                                        <td>@Convert.ToDouble(Model.summary[i].ot3_0.TotalHours).ToString("#.#")</td>
                                    </tr>
                                }
                                else
                                {
                                    <tr>
                                        <td>@(i + 1)</td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                    </tr>
                                }
                            }
                            <tr>
                                <td colspan="2">รวม</td>
                                <td>@Model.total_normal</td>
                                <td>@Model.total_ot1_5</td>
                                <td>@Model.total_ot3_0</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </form>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/datatables/1.10.21/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/admin-lte/3.2.0/js/adminlte.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.7.1/chart.min.js"></script>
</body>
</html>